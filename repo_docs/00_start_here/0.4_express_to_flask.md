# ğŸ”„ Express.js to Flask Translation Guide

> **Everything You Know from Express, Now in Flask**

---

## ğŸ“‹ Concept Mapping

This is your Rosetta Stone. When you know something in Express, find its Flask equivalent here.

---

## ğŸš€ Application Setup

### Express.js

```javascript
// app.js
const express = require("express");
const app = express();

// Middleware
app.use(express.json());
app.use(cors());

// Routes
app.use("/api/users", userRoutes);

// Start server
app.listen(3000, () => console.log("Server running"));
```

### Flask

```python
# app/__init__.py
from flask import Flask

def create_app():
    app = Flask(__name__)

    # Extensions (like middleware)
    from flask_cors import CORS
    CORS(app)

    # Routes (Blueprints)
    from app.routes import users_bp
    app.register_blueprint(users_bp, url_prefix='/api/users')

    return app

# run.py
app = create_app()
app.run(port=5000)
```

### Key Differences

| Aspect             | Express          | Flask                 |
| ------------------ | ---------------- | --------------------- |
| App creation       | `express()`      | `Flask(__name__)`     |
| Factory pattern    | Optional         | Recommended           |
| Built-in JSON      | `express.json()` | Automatic in Flask 2+ |
| Route organization | `Router()`       | `Blueprint()`         |

---

## ğŸ›£ï¸ Routing

### Express.js

```javascript
// routes/users.js
const router = express.Router();

router.get("/", getAllUsers);
router.get("/:id", getUserById);
router.post("/", createUser);
router.put("/:id", updateUser);
router.delete("/:id", deleteUser);

module.exports = router;
```

### Flask

```python
# app/routes/users.py
from flask_openapi3 import APIBlueprint

users_bp = APIBlueprint('users', __name__)

@users_bp.get('/')
def get_all_users():
    ...

@users_bp.get('/<int:id>')  # Note: type specified!
def get_user_by_id(id):
    ...

@users_bp.post('/')
def create_user():
    ...

@users_bp.put('/<int:id>')
def update_user(id):
    ...

@users_bp.delete('/<int:id>')
def delete_user(id):
    ...
```

### Key Differences

| Aspect          | Express          | Flask                  |
| --------------- | ---------------- | ---------------------- |
| Route params    | `:id`            | `<id>` or `<int:id>`   |
| HTTP methods    | `router.get()`   | `@bp.get()` decorator  |
| Type conversion | Manual           | `<int:id>` automatic   |
| Module export   | `module.exports` | Blueprint registration |

---

## ğŸ“¥ Request Handling

### Express.js

```javascript
router.post("/users", (req, res) => {
    const { username, email } = req.body;
    const { page } = req.query;
    const { authorization } = req.headers;
    const { id } = req.params;

    // ... do something
    res.json({ success: true, data: user });
});
```

### Flask

```python
from flask import request, jsonify

@users_bp.post('/users')
def create_user():
    data = request.get_json()           # req.body
    username = data.get('username')

    page = request.args.get('page')     # req.query
    auth = request.headers.get('Authorization')  # req.headers

    # For URL params, they come as function arguments
    # See: /users/<id> â†’ def get_user(id):

    return jsonify({'success': True, 'data': user})
```

### Request Object Comparison

| Express `req.` | Flask `request.`     | Notes        |
| -------------- | -------------------- | ------------ |
| `req.body`     | `request.get_json()` | Returns dict |
| `req.query`    | `request.args`       | MultiDict    |
| `req.params`   | Function argument    | Different!   |
| `req.headers`  | `request.headers`    | Same concept |
| `req.method`   | `request.method`     | Same         |
| `req.path`     | `request.path`       | Same         |
| `req.cookies`  | `request.cookies`    | Same         |

---

## ğŸ“¤ Response Handling

### Express.js

```javascript
// JSON response
res.json({ message: "Hello" });

// With status code
res.status(201).json({ user: newUser });

// Error response
res.status(404).json({ error: "Not found" });

// Set header
res.set("X-Custom", "value");
res.json(data);
```

### Flask

```python
from flask import jsonify, make_response

# JSON response
return jsonify({'message': 'Hello'})

# With status code
return jsonify({'user': new_user}), 201

# Error response
return jsonify({'error': 'Not found'}), 404

# Set header
response = make_response(jsonify(data))
response.headers['X-Custom'] = 'value'
return response

# Or use tuple: (body, status, headers)
return jsonify(data), 200, {'X-Custom': 'value'}
```

---

## ğŸ”Œ Middleware â†’ Decorators

### Express.js Middleware

```javascript
// Authentication middleware
const authMiddleware = (req, res, next) => {
    const token = req.headers.authorization;
    if (!token) {
        return res.status(401).json({ error: "No token" });
    }
    req.user = verifyToken(token);
    next();
};

// Apply to route
router.get("/profile", authMiddleware, getProfile);

// Apply to all routes
app.use(authMiddleware);
```

### Flask Decorators

```python
from functools import wraps
from flask import request, g

# Authentication decorator
def auth_required(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        token = request.headers.get('Authorization')
        if not token:
            return jsonify({'error': 'No token'}), 401
        g.user = verify_token(token)  # g = request context
        return f(*args, **kwargs)
    return decorated

# Apply to route
@users_bp.get('/profile')
@auth_required
def get_profile():
    user = g.user  # Access authenticated user
    ...

# Apply to all routes in blueprint
@users_bp.before_request
def check_auth():
    # Runs before every request in this blueprint
    ...
```

### Key Differences

| Express              | Flask                             |
| -------------------- | --------------------------------- |
| `next()` to continue | Just return `f(*args, **kwargs)`  |
| `req.user = data`    | `g.user = data` (request context) |
| `app.use()` global   | `@app.before_request`             |
| Chain of middleware  | Decorator stacking                |

---

## ğŸ—„ï¸ Database Models

### Express.js with Mongoose

```javascript
// models/User.js
const mongoose = require("mongoose");

const userSchema = new mongoose.Schema({
    username: { type: String, required: true },
    email: { type: String, required: true, unique: true },
    password: { type: String, required: true },
    createdAt: { type: Date, default: Date.now },
});

module.exports = mongoose.model("User", userSchema);
```

### Flask with SQLAlchemy

```python
# app/models/user.py
from app import db
from datetime import datetime

class User(db.Model):
    __tablename__ = 'users'

    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(50), nullable=False)
    email = db.Column(db.String(120), nullable=False, unique=True)
    password_hash = db.Column(db.String(256), nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
```

### CRUD Operations Comparison

| Operation  | Mongoose                   | SQLAlchemy                                  |
| ---------- | -------------------------- | ------------------------------------------- |
| Create     | `User.create({...})`       | `user = User(...); db.session.add(user)`    |
| Find All   | `User.find()`              | `User.query.all()`                          |
| Find One   | `User.findOne({email})`    | `User.query.filter_by(email=email).first()` |
| Find by ID | `User.findById(id)`        | `User.query.get(id)`                        |
| Update     | `User.findByIdAndUpdate()` | `user.name = 'new'; db.session.commit()`    |
| Delete     | `User.findByIdAndDelete()` | `db.session.delete(user)`                   |
| Save       | Automatic                  | `db.session.commit()`                       |

---

## âœ… Validation

### Express.js with Joi

```javascript
const Joi = require("joi");

const userSchema = Joi.object({
    username: Joi.string().min(3).max(50).required(),
    email: Joi.string().email().required(),
    password: Joi.string().min(8).required(),
});

router.post("/users", (req, res) => {
    const { error, value } = userSchema.validate(req.body);
    if (error) {
        return res.status(400).json({ error: error.details });
    }
    // value is validated data
});
```

### Flask with Pydantic

```python
from pydantic import BaseModel, EmailStr, Field

class UserCreateSchema(BaseModel):
    username: str = Field(min_length=3, max_length=50)
    email: EmailStr
    password: str = Field(min_length=8)

@users_bp.post('/users')
def create_user():
    data = request.get_json()
    try:
        validated = UserCreateSchema(**data)
        # validated.username, validated.email, etc.
    except ValidationError as e:
        return jsonify({'error': e.errors()}), 400
```

---

## âŒ Error Handling

### Express.js

```javascript
// Error handler middleware (must be last)
app.use((err, req, res, next) => {
    console.error(err.stack);
    res.status(err.status || 500).json({
        error: err.message,
    });
});

// In routes
router.get("/users/:id", async (req, res, next) => {
    try {
        const user = await User.findById(req.params.id);
        if (!user) {
            const error = new Error("User not found");
            error.status = 404;
            throw error;
        }
        res.json(user);
    } catch (err) {
        next(err); // Pass to error handler
    }
});
```

### Flask

```python
# Error handlers in app factory
@app.errorhandler(404)
def not_found(error):
    return jsonify({'error': 'Not found'}), 404

@app.errorhandler(500)
def internal_error(error):
    return jsonify({'error': 'Internal server error'}), 500

# In routes - exceptions are caught automatically
@users_bp.get('/users/<int:id>')
def get_user(id):
    user = User.query.get(id)
    if not user:
        abort(404)  # Triggers 404 error handler
    return jsonify(user.to_dict())

# Or raise custom exceptions
class UserNotFoundError(Exception):
    pass

@app.errorhandler(UserNotFoundError)
def handle_user_not_found(error):
    return jsonify({'error': str(error)}), 404
```

---

## ğŸŒ Environment Variables

### Express.js

```javascript
require("dotenv").config();

const dbUrl = process.env.DATABASE_URL;
const secret = process.env.SECRET_KEY;
```

### Flask

```python
from dotenv import load_dotenv
import os

load_dotenv()  # Usually in config.py or app factory

db_url = os.environ.get('DATABASE_URL')
secret = os.environ.get('SECRET_KEY')

# Or use Flask's config
app.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')
```

---

## ğŸ“¦ Package Management

| Task              | npm                      | pip                               |
| ----------------- | ------------------------ | --------------------------------- |
| Install package   | `npm install flask`      | `pip install Flask`               |
| Install from file | `npm install`            | `pip install -r requirements.txt` |
| List packages     | `npm list`               | `pip list`                        |
| Freeze versions   | `npm shrinkwrap`         | `pip freeze > requirements.txt`   |
| Dev dependencies  | `npm install --save-dev` | Comment in requirements.txt       |

---

## ğŸ”‘ Quick Reference Card

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                EXPRESS â†’ FLASK CHEATSHEET                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  express()           â†’  Flask(__name__)                          â”‚
â”‚  app.use()           â†’  @app.before_request                      â”‚
â”‚  router.get()        â†’  @bp.get()                                â”‚
â”‚  req.body            â†’  request.get_json()                       â”‚
â”‚  req.params.id       â†’  function argument (id)                   â”‚
â”‚  req.query           â†’  request.args                             â”‚
â”‚  res.json()          â†’  jsonify()                                â”‚
â”‚  res.status(201)     â†’  return ..., 201                          â”‚
â”‚  next()              â†’  return f(*args, **kwargs)                â”‚
â”‚  req.user            â†’  g.user                                   â”‚
â”‚  try/catch           â†’  try/except                               â”‚
â”‚  async/await         â†’  (sync by default, async optional)        â”‚
â”‚  module.exports      â†’  (just import the file)                   â”‚
â”‚  require()           â†’  import / from ... import                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”œ Next Steps

Now you have the mental model for Flask. Let's get the app running!

**Next: [0.5_quick_start.md](./0.5_quick_start.md)** - Get the application running in 5 minutes.

# 7.1 DevOps Overview

> **Understanding the Development and Deployment Infrastructure**

This document provides an overview of the DevOps setup in our Flask application, explaining what tools we use, why we chose them, and how they work together.

---

## Table of Contents

1. [What is DevOps?](#what-is-devops)
2. [Our DevOps Stack](#our-devops-stack)
3. [Local Development](#local-development)
4. [Code Quality](#code-quality)
5. [Continuous Integration](#continuous-integration)
6. [Production Deployment](#production-deployment)
7. [File Overview](#file-overview)

---

## What is DevOps?

### Definition

**DevOps** combines **Development** and **Operations** practices to:

-   Automate repetitive tasks
-   Ensure code quality
-   Enable reliable deployments
-   Improve collaboration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Traditional Workflow                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Developer â†’ Manual Testing â†’ Manual Deploy â†’ Hope it works ðŸ¤ž          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DevOps Workflow                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Developer                                                               â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Pre-commit hooks (automatic)                                     â”‚    â”‚
â”‚  â”‚ â€¢ Format code (Black)                                           â”‚    â”‚
â”‚  â”‚ â€¢ Sort imports (isort)                                          â”‚    â”‚
â”‚  â”‚ â€¢ Lint (flake8)                                                 â”‚    â”‚
â”‚  â”‚ â€¢ Security scan (bandit)                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ GitHub Actions CI (automatic)                                    â”‚    â”‚
â”‚  â”‚ â€¢ Run tests                                                      â”‚    â”‚
â”‚  â”‚ â€¢ Check coverage                                                 â”‚    â”‚
â”‚  â”‚ â€¢ Build Docker image                                            â”‚    â”‚
â”‚  â”‚ â€¢ Security scanning                                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚      â”‚                                                                   â”‚
â”‚      â–¼                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Deployment (automatic or manual)                                 â”‚    â”‚
â”‚  â”‚ â€¢ Deploy to staging                                             â”‚    â”‚
â”‚  â”‚ â€¢ Run smoke tests                                               â”‚    â”‚
â”‚  â”‚ â€¢ Deploy to production                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Our DevOps Stack

### Tools Overview

| Tool/Technology    | Purpose                       | File/Location             |
| ------------------ | ----------------------------- | ------------------------- |
| **Docker**         | Containerization              | `Dockerfile`              |
| **Docker Compose** | Multi-container orchestration | `docker-compose.yml`      |
| **Pre-commit**     | Local quality checks          | `.pre-commit-config.yaml` |
| **GitHub Actions** | CI/CD pipeline                | `.github/workflows/`      |
| **Black**          | Code formatting               | (via pre-commit)          |
| **isort**          | Import sorting                | (via pre-commit)          |
| **Flake8**         | Linting                       | (via pre-commit)          |
| **Bandit**         | Security scanning             | (via pre-commit)          |
| **Make**           | Task automation               | `Makefile`                |

### Why These Tools?

| Tool           | Why We Use It                                   |
| -------------- | ----------------------------------------------- |
| Docker         | Consistent environment across dev/staging/prod  |
| Pre-commit     | Catch issues before they reach the repo         |
| GitHub Actions | Free CI for GitHub repos, excellent integration |
| Black + isort  | No bikeshedding over code style                 |
| Flake8         | Catch potential bugs and bad practices          |
| Make           | Simple task runner, available everywhere        |

---

## Local Development

### Without Docker

```bash
# Create virtual environment
python -m venv venv
source venv/bin/activate

# Install dependencies
pip install -r requirements.txt

# Set environment variables
cp .env.example .env
# Edit .env with your values

# Run migrations
flask db upgrade

# Start development server
flask run --port 5500
```

### With Docker (Recommended)

```bash
# Start all services (app, database, redis)
docker compose up

# Run in background
docker compose up -d

# View logs
docker compose logs -f web

# Stop all services
docker compose down
```

### Using Makefile

```bash
# Start development
make dev

# Run tests
make test

# Format code
make format

# Run linters
make lint

# Clean up
make clean
```

---

## Code Quality

### Pre-commit Hooks

Pre-commit runs checks automatically before each `git commit`:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Pre-commit Flow                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  $ git commit -m "feat: add new feature"                                â”‚
â”‚                                                                          â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. check-added-large-files    âœ… Passed                         â”‚    â”‚
â”‚  â”‚ 2. check-merge-conflict       âœ… Passed                         â”‚    â”‚
â”‚  â”‚ 3. trailing-whitespace        ðŸ“ Fixed                          â”‚    â”‚
â”‚  â”‚ 4. black (formatting)         ðŸ“ Reformatted 2 files            â”‚    â”‚
â”‚  â”‚ 5. isort (imports)            ðŸ“ Sorted imports                 â”‚    â”‚
â”‚  â”‚ 6. flake8 (linting)           âŒ Failed                         â”‚    â”‚
â”‚  â”‚    â†’ app/routes/users.py:42 F401 unused import                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â–¼                                                                  â”‚
â”‚  COMMIT BLOCKED - Fix flake8 errors and try again                       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Installation

```bash
# Install pre-commit
pip install pre-commit

# Install hooks
pre-commit install
pre-commit install --hook-type commit-msg

# Run on all files (first time)
pre-commit run --all-files
```

### Checks Performed

| Hook                   | What It Checks                  |
| ---------------------- | ------------------------------- |
| `check-large-files`    | Files > 1MB                     |
| `check-merge-conflict` | Leftover merge conflict markers |
| `trailing-whitespace`  | Trailing whitespace             |
| `black`                | Code formatting (PEP 8 style)   |
| `isort`                | Import order and grouping       |
| `flake8`               | Python linting (errors, style)  |
| `mypy`                 | Type checking (optional)        |
| `bandit`               | Security vulnerabilities        |
| `conventional-commits` | Commit message format           |

---

## Continuous Integration

### GitHub Actions Pipeline

Our CI pipeline runs on every push and pull request:

```yaml
# .github/workflows/ci.yml

name: CI

on:
    push:
        branches: [main, develop]
    pull_request:
        branches: [main, develop]

jobs:
    lint:
        # Check code formatting, linting, types

    security:
        # Run security scans with Bandit

    test:
        # Run tests with pytest

    build:
        # Build Docker image (on main only)
```

### Pipeline Stages

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CI Pipeline                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Push/PR to main or develop                                              â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚       â–¼                â–¼                â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚  Lint   â”‚      â”‚Security â”‚      â”‚  Test   â”‚  (parallel)              â”‚
â”‚  â”‚         â”‚      â”‚  Scan   â”‚      â”‚         â”‚                          â”‚
â”‚  â”‚ black   â”‚      â”‚ bandit  â”‚      â”‚ pytest  â”‚                          â”‚
â”‚  â”‚ isort   â”‚      â”‚ safety  â”‚      â”‚ coverageâ”‚                          â”‚
â”‚  â”‚ flake8  â”‚      â”‚         â”‚      â”‚         â”‚                          â”‚
â”‚  â”‚ mypy    â”‚      â”‚         â”‚      â”‚         â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                          â”‚
â”‚       â”‚                â”‚                â”‚                                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                        â”‚                                                 â”‚
â”‚                        â–¼                                                 â”‚
â”‚              All passed? â”€â”€Noâ”€â”€â–º âŒ PR Blocked                          â”‚
â”‚                        â”‚                                                 â”‚
â”‚                       Yes                                                â”‚
â”‚                        â”‚                                                 â”‚
â”‚                        â–¼                                                 â”‚
â”‚               âœ… Ready to Merge                                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Production Deployment

### Docker Production Build

```bash
# Build production image
docker build --target production -t myapp:latest .

# Run production container
docker run -p 5500:5500 \
  -e DATABASE_URL=postgresql://... \
  -e SECRET_KEY=... \
  myapp:latest
```

### Production Considerations

| Aspect           | Development       | Production           |
| ---------------- | ----------------- | -------------------- |
| **Server**       | Flask dev server  | Gunicorn (4 workers) |
| **Debug**        | Enabled           | Disabled             |
| **Logging**      | Console (colored) | JSON to file         |
| **Database**     | Local PostgreSQL  | Managed PostgreSQL   |
| **Static files** | Flask serves      | Nginx or CDN         |
| **HTTPS**        | No                | Required (via proxy) |

---

## File Overview

### DevOps Files in Project

```
flaskwithpsql/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml                    # Main CI pipeline
â”‚       â””â”€â”€ dependency-check.yml      # Dependency updates
â”‚
â”œâ”€â”€ docker/
â”‚   â””â”€â”€ init-db.sql                   # Database initialization
â”‚
â”œâ”€â”€ .dockerignore                      # Files to exclude from Docker builds
â”œâ”€â”€ .env.example                       # Environment variable template
â”œâ”€â”€ .gitignore                         # Files to exclude from Git
â”œâ”€â”€ .pre-commit-config.yaml            # Pre-commit hooks configuration
â”‚
â”œâ”€â”€ Dockerfile                         # Multi-stage Docker build
â”œâ”€â”€ docker-compose.yml                 # Development orchestration
â”œâ”€â”€ docker-compose.prod.yml            # Production overrides
â”‚
â”œâ”€â”€ Makefile                           # Task automation
â”œâ”€â”€ pyproject.toml                     # Python project configuration
â””â”€â”€ requirements.txt                   # Python dependencies
```

### Quick Reference

| Task                   | Command                              |
| ---------------------- | ------------------------------------ |
| Start development      | `docker compose up` or `make dev`    |
| Run tests              | `make test` or `pytest`              |
| Format code            | `make format` or `black .`           |
| Lint code              | `make lint` or `flake8 app/`         |
| Build production image | `docker build --target production .` |
| Run pre-commit         | `pre-commit run --all-files`         |

---

## Summary

Our DevOps setup provides:

1. **Consistent environments** via Docker
2. **Automatic code quality checks** via pre-commit
3. **Continuous integration** via GitHub Actions
4. **Simple task automation** via Makefile

---

## Next Steps

-   **[7.2 Docker Basics](./7.2_docker_basics.md)** - Container concepts
-   **[7.3 Dockerfile Explained](./7.3_dockerfile_explained.md)** - Line-by-line breakdown
-   **[7.5 Pre-commit Hooks](./7.5_pre_commit_hooks.md)** - Quality automation

---

> **Related Documentation:**
>
> -   [README.md](../../README.md) - Quick start guide
> -   [CONTRIBUTING.md](../../CONTRIBUTING.md) - Contribution guidelines

# ğŸ“¥ Imports and Modules Explained

> **How Python Organizes and Shares Code**

---

## ğŸ“‹ Overview

In Python, a **module** is simply a `.py` file. A **package** is a folder containing Python files. The import system lets you use code from other modules.

---

## ğŸ†š Node.js Comparison

| Concept        | Node.js                     | Python                      |
| -------------- | --------------------------- | --------------------------- |
| Import module  | `require()` or `import`     | `import`                    |
| Export         | `module.exports` / `export` | Just define (auto-exported) |
| Default export | `export default`            | N/A (import the file)       |
| Named export   | `export { func }`           | Just define the function    |
| Package marker | `package.json`              | `__init__.py`               |

---

## ğŸ“¦ Basic Imports

### Importing a Module

**JavaScript:**

```javascript
const fs = require("fs");
// or
import fs from "fs";
```

**Python:**

```python
import os    # Built-in module

# Use as:
os.path.exists('file.txt')
```

### Importing Specific Items

**JavaScript:**

```javascript
import { readFile, writeFile } from "fs";
```

**Python:**

```python
from os.path import exists, join

# Use directly:
exists('file.txt')
join('folder', 'file.txt')
```

### Importing with Alias

**JavaScript:**

```javascript
import * as utils from "./utils";
import { reallyLongName as short } from "./module";
```

**Python:**

```python
import numpy as np         # Common alias
from os.path import join as path_join

np.array([1, 2, 3])
path_join('a', 'b')
```

---

## ğŸ“‚ Module Types

### 1. Built-in Modules (Like Node.js core modules)

```python
import os           # Operating system
import sys          # System-specific
import json         # JSON parsing
import datetime     # Date/time
import re           # Regular expressions
import logging      # Logging
```

### 2. Third-party Modules (Like npm packages)

```python
from flask import Flask        # Installed via pip
from sqlalchemy import Column
import requests                # HTTP library
```

### 3. Your Own Modules (Local files)

```python
# If you have: utils.py
import utils
from utils import helper_function

# If you have: app/models/user.py
from app.models.user import User
from app.models import User    # If exported in __init__.py
```

---

## ğŸ“ Understanding Packages

A **package** is a folder with an `__init__.py` file:

```
mypackage/
â”œâ”€â”€ __init__.py       # Makes it a package
â”œâ”€â”€ module1.py
â”œâ”€â”€ module2.py
â””â”€â”€ subpackage/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ module3.py
```

### The `__init__.py` File

```python
# mypackage/__init__.py

# This file can be empty, or it can:
# 1. Define what gets exported
# 2. Run initialization code
# 3. Provide convenient imports

from mypackage.module1 import func1
from mypackage.module2 import func2

__all__ = ['func1', 'func2']  # What 'from mypackage import *' exports
```

### Importing from Packages

```python
# Import the package
import mypackage
mypackage.func1()

# Import specific module
from mypackage import module1
module1.func1()

# Import specific function
from mypackage.module1 import func1
func1()

# Import from subpackage
from mypackage.subpackage.module3 import something
```

---

## ğŸ” Our Project's Structure

```
app/
â”œâ”€â”€ __init__.py              # Makes 'app' a package, contains create_app()
â”œâ”€â”€ version.py               # Single file module
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ __init__.py          # Exports User, db
â”‚   â”œâ”€â”€ base.py              # BaseModel class
â”‚   â””â”€â”€ user.py              # User model
â”‚
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ __init__.py          # Exports blueprints
â”‚   â”œâ”€â”€ main.py              # Main routes
â”‚   â””â”€â”€ users.py             # User routes
â”‚
â”œâ”€â”€ schemas/
â”‚   â”œâ”€â”€ __init__.py          # Exports all schemas
â”‚   â”œâ”€â”€ base.py
â”‚   â”œâ”€â”€ user.py
â”‚   â””â”€â”€ validators.py
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py          # Exports UserService
â”‚   â””â”€â”€ user_service.py
â”‚
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py          # Exports utilities
    â”œâ”€â”€ responses.py
    â””â”€â”€ error_handlers.py
```

### How Imports Work in Our Project

```python
# From anywhere, you can do:
from app import create_app, db          # From app/__init__.py
from app.models import User             # From app/models/__init__.py
from app.models.user import User        # Direct import
from app.routes.users import users_bp   # Blueprint
from app.schemas import UserCreateSchema
from app.services import UserService
from app.utils.responses import success_response
```

### Example `__init__.py` Files

**app/models/**init**.py:**

```python
"""
Models Package.

This makes importing models cleaner:
    from app.models import User
Instead of:
    from app.models.user import User
"""

from app.models.base import BaseModel
from app.models.user import User

__all__ = ['BaseModel', 'User']
```

**app/schemas/**init**.py:**

```python
"""
Schemas Package - Pydantic validation schemas.
"""

from app.schemas.base import BaseSchema
from app.schemas.user import (
    UserCreateSchema,
    UserUpdateSchema,
    UserResponseSchema,
    UserLoginSchema,
)
from app.schemas.validators import (
    validate_username,
    validate_email,
    validate_password,
)

__all__ = [
    'BaseSchema',
    'UserCreateSchema',
    'UserUpdateSchema',
    'UserResponseSchema',
    'UserLoginSchema',
    'validate_username',
    'validate_email',
    'validate_password',
]
```

---

## ğŸ”„ Import Types Explained

### Absolute Imports (Recommended)

Always start from the package root:

```python
# From app/routes/users.py
from app.models import User           # Start from 'app'
from app.schemas import UserCreateSchema
from app.services import UserService
```

### Relative Imports

Use dots to indicate relative location:

```python
# From app/routes/users.py
from ..models import User           # Go up one level (..), then into models
from ..schemas import UserCreateSchema
from . import main                  # Same package (routes)
```

**When to use:**

-   Absolute: Most of the time (clearer, easier to understand)
-   Relative: Only in tightly coupled subpackages

---

## ğŸ”„ How Python Finds Modules

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PYTHON IMPORT SEARCH ORDER                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   import somemodule                                              â”‚
â”‚                                                                  â”‚
â”‚   Python looks in this order:                                    â”‚
â”‚                                                                  â”‚
â”‚   1. Built-in modules                                            â”‚
â”‚      â””â”€â”€ sys, os, json, etc.                                     â”‚
â”‚                                                                  â”‚
â”‚   2. Current directory                                           â”‚
â”‚      â””â”€â”€ ./somemodule.py                                         â”‚
â”‚                                                                  â”‚
â”‚   3. PYTHONPATH environment variable                             â”‚
â”‚      â””â”€â”€ Usually empty                                           â”‚
â”‚                                                                  â”‚
â”‚   4. Site-packages (installed packages)                          â”‚
â”‚      â””â”€â”€ venv/lib/python3.9/site-packages/                       â”‚
â”‚                                                                  â”‚
â”‚   Not found? â†’ ImportError!                                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

You can check the search path:

```python
import sys
print(sys.path)
```

---

## âš ï¸ Common Import Gotchas

### 1. Circular Imports

```python
# models/user.py
from app.services import UserService  # Imports user_service.py

# services/user_service.py
from app.models import User           # Imports user.py

# ğŸ’¥ Circular import! Python can't resolve this.
```

**Solutions:**

```python
# Solution 1: Import inside function
def create_user():
    from app.models import User   # Import when needed
    ...

# Solution 2: Reorganize code
# Keep dependencies one-way: routes â†’ services â†’ models

# Solution 3: Import at bottom of file
class UserService:
    ...

from app.models import User  # After class definition
```

### 2. Importing from Parent Package

```python
# Wrong (from app/routes/users.py)
import models           # Python doesn't know where 'models' is

# Correct
from app.models import User
```

### 3. Name Conflicts

```python
# Dangerous - shadows built-in
from typing import List
list = []    # Now 'list' is your variable, not the built-in!

# Also dangerous
json = {"key": "value"}
import json  # ğŸ’¥ Conflict!

# Solution: Use different names
data = {"key": "value"}
import json
```

### 4. Running Scripts Directly

```python
# This fails if you run: python app/routes/users.py
from app.models import User  # ImportError: No module named 'app'

# Why? Python doesn't know 'app' is a package when running directly.

# Solution: Run from project root
python -m app.routes.users
# Or better: Only run run.py from root
```

---

## ğŸ“ Import Best Practices

### 1. Order Your Imports

```python
# Standard library
import os
import sys
from datetime import datetime

# Third-party packages
from flask import Flask, request
from sqlalchemy import Column

# Local imports
from app.models import User
from app.utils import helpers
```

**Note:** `isort` (in our pre-commit) does this automatically!

### 2. Avoid Wildcard Imports

```python
# Bad - What did we actually import?
from app.models import *

# Good - Explicit is better
from app.models import User, BaseModel
```

### 3. Group Related Imports

```python
# Flask ecosystem
from flask import Flask, request, jsonify
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate

# Our app
from app.models import User
from app.schemas import UserSchema
```

---

## ğŸ§ª Practice: Understanding Our Imports

Look at `app/routes/users.py`:

```python
# Third-party
from flask_openapi3 import APIBlueprint, Tag
from pydantic import BaseModel, Field

# Our app - schemas
from app.schemas import (
    UserCreateSchema,
    UserLoginSchema,
    UserResponseSchema,
    UserUpdateSchema,
)

# Our app - services
from app.services import (
    InvalidCredentialsError,
    UserAlreadyExistsError,
    UserNotFoundError,
    UserService,
)

# Our app - utilities
from app.utils.rate_limiter import api_limit
from app.utils.responses import (
    ErrorCode,
    StandardErrorResponse,
    StandardSuccessResponse,
    error_response,
    success_response,
)
```

This tells us:

-   The route depends on schemas for validation
-   It uses the service layer for business logic
-   It uses utility functions for responses
-   Clear separation of concerns!

---

## ğŸ”œ Next Steps

Now you understand how Python imports work. Next, let's dive into one of Python's most powerful features: decorators.

**Next: [1.4_decorators_explained.md](./1.4_decorators_explained.md)** - The @decorator syntax deep dive.

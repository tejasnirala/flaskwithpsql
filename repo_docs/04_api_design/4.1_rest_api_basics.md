# ğŸŒ REST API Basics

> **Understanding RESTful API Design**

---

## ğŸ“‹ What is REST?

**REST** (Representational State Transfer) is an architectural style for designing networked applications. It's not a protocol, but a set of constraints and principles.

---

## ğŸ“Š REST Principles

### 1. Client-Server

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         HTTP Request          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚             â”‚
â”‚   Client    â”‚                               â”‚   Server    â”‚
â”‚  (Frontend) â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  (Backend)  â”‚
â”‚             â”‚         HTTP Response          â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Separation of concerns:
- Client handles UI/UX
- Server handles data and business logic
```

### 2. Stateless

Each request contains ALL information needed to process it. The server doesn't remember previous requests.

```python
# âŒ NOT STATELESS - Server remembers user
@app.route('/get-cart')
def get_cart():
    return cart[session['user_id']]  # Relies on session state

# âœ… STATELESS - Each request is self-contained
@app.route('/get-cart')
@jwt_required()
def get_cart():
    user_id = get_jwt_identity()  # ID from the token
    return get_cart_for_user(user_id)
```

### 3. Resource-Based

Everything is a **resource** (noun), identified by URIs.

```
/users          â† Collection of users
/users/123      â† Specific user
/users/123/posts â† Posts belonging to user 123
/posts          â† Collection of all posts
```

### 4. HTTP Methods = Actions

| Method   | Purpose         | CRUD   | Idempotent |
| -------- | --------------- | ------ | ---------- |
| `GET`    | Read resource   | Read   | âœ… Yes     |
| `POST`   | Create resource | Create | âŒ No      |
| `PUT`    | Replace/Update  | Update | âœ… Yes     |
| `PATCH`  | Partial update  | Update | âŒ No      |
| `DELETE` | Remove resource | Delete | âœ… Yes     |

### 5. Uniform Interface

Consistent patterns across all resources.

---

## ğŸ“Š Resource Naming Conventions

### âœ… Good Naming

```
GET    /users              â† Get all users
GET    /users/123          â† Get user 123
POST   /users              â† Create new user
PUT    /users/123          â† Update user 123
DELETE /users/123          â† Delete user 123

GET    /users/123/posts    â† Get user's posts
GET    /posts/456/comments â† Get post's comments
```

### âŒ Bad Naming

```
GET    /getUsers           â† Verb in URL
GET    /user               â† Singular (should be plural)
POST   /createUser         â† Verb in URL
GET    /getAllActiveUsers  â† Action in URL
POST   /users/delete/123   â† Wrong method
```

---

## ğŸ“Š HTTP Status Codes

### 2xx - Success

| Code | Name       | Use Case                           |
| ---- | ---------- | ---------------------------------- |
| 200  | OK         | Successful GET, PUT, PATCH         |
| 201  | Created    | Successful POST (resource created) |
| 204  | No Content | Successful DELETE                  |

### 4xx - Client Errors

| Code | Name              | Use Case                         |
| ---- | ----------------- | -------------------------------- |
| 400  | Bad Request       | Malformed request, invalid JSON  |
| 401  | Unauthorized      | Not authenticated                |
| 403  | Forbidden         | Authenticated but not authorized |
| 404  | Not Found         | Resource doesn't exist           |
| 409  | Conflict          | Duplicate resource               |
| 422  | Unprocessable     | Validation errors                |
| 429  | Too Many Requests | Rate limit exceeded              |

### 5xx - Server Errors

| Code | Name                  | Use Case                |
| ---- | --------------------- | ----------------------- |
| 500  | Internal Server Error | Unexpected server error |
| 502  | Bad Gateway           | Upstream server error   |
| 503  | Service Unavailable   | Server temporarily down |

---

## ğŸ¯ Our API Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OUR API STRUCTURE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   BASE URL:  http://localhost:5000/api/v1                        â”‚
â”‚                                                                  â”‚
â”‚   ENDPOINTS:                                                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚   AUTH (Authentication):                                         â”‚
â”‚   POST   /api/v1/auth/register     â† Register new user           â”‚
â”‚   POST   /api/v1/auth/login        â† Login and get tokens        â”‚
â”‚   POST   /api/v1/auth/refresh      â† Refresh access token        â”‚
â”‚   POST   /api/v1/auth/logout       â† Logout (invalidate token)   â”‚
â”‚                                                                  â”‚
â”‚   USERS (User Management):                                       â”‚
â”‚   GET    /api/v1/users             â† List all users              â”‚
â”‚   GET    /api/v1/users/{id}        â† Get specific user           â”‚
â”‚   PUT    /api/v1/users/{id}        â† Update user                 â”‚
â”‚   DELETE /api/v1/users/{id}        â† Delete user (soft)          â”‚
â”‚                                                                  â”‚
â”‚   HEALTH (Monitoring):                                           â”‚
â”‚   GET    /api/v1/                  â† Welcome/root endpoint       â”‚
â”‚   GET    /api/v1/health            â† Health check                â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Response Envelope Pattern

We use a **response envelope** for ALL responses:

### Success Response

```json
{
    "success": true,
    "data": {
        "id": 1,
        "username": "john_doe",
        "email": "john@example.com"
    },
    "error": null,
    "meta": {
        "page": 1,
        "per_page": 10,
        "total": 100
    }
}
```

### Error Response

```json
{
    "success": false,
    "data": null,
    "error": {
        "code": "VALIDATION_ERROR",
        "message": "Validation failed",
        "details": {
            "email": "Invalid email format"
        }
    },
    "meta": null
}
```

---

## ğŸ†š Comparison with Express.js

### Express.js Route

```javascript
// routes/users.js
router.get("/users", async (req, res) => {
    try {
        const users = await User.find();
        res.json({ success: true, data: users });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.get("/users/:id", async (req, res) => {
    // ...
});
```

### Flask Route (Our Approach)

```python
# app/routes/v1/users.py
@users_bp_v1.get("/")
def get_users(query: UserListQuery):
    users, total = UserService.get_all(
        page=query.page,
        per_page=query.per_page,
    )
    return success_response(data=users_data, meta={...})

@users_bp_v1.get("/<int:user_id>")
def get_user(path: UserPath):
    user = UserService.get_by_id_or_404(path.user_id)
    return success_response(data=user)
```

Same patterns, different syntax!

---

## ğŸ“‹ API Versioning

We use **URL-based versioning**:

```
/api/v1/users    â† Version 1
/api/v2/users    â† Version 2 (future)
```

**Why URL versioning?**

1. Explicit and visible
2. Easy to test different versions
3. Clear separation between versions
4. Works with all HTTP clients

**Alternatives (not used):**

```
# Header versioning
Accept: application/vnd.myapi.v1+json

# Query parameter
/api/users?version=1
```

---

## ğŸ”œ Next Steps

Now let's see how flask-openapi3 helps build and document our API.

**Next: [4.2_openapi_swagger.md](./4.2_openapi_swagger.md)** - flask-openapi3 overview.
